<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Joining data from multiple sources</title>
    <meta charset="utf-8" />
    <meta name="author" content="DATA 202 21FA, based on datasciencebox.org" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/font-awesome/css/all.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/v4-shims.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <script src="libs/freezeframe/freezeframe.min.js"></script>
    <script src="libs/xaringanExtra-freezeframe/freezeframe-init.js"></script>
    <script id="xaringanExtra-freezeframe-options" type="application/json">{"selector":"img[src$=\"gif\"]","trigger":"click","overlay":true,"responsive":true,"warnings":true}</script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="slides.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Joining data from multiple sources
### DATA 202 21FA, based on <a href="https://datasciencebox.org/">datasciencebox.org</a>

---










## Q&amp;A

&gt; What does `%in%` do?

- Don't confuse with `%&gt;%` or `==`


```r
nobel %&gt;% filter(country == c("USA", "France"))
```

(doesn't work!)


```r
nobel %&gt;% filter(country %in% c("USA", "France"))
```

```
# A tibble: 388 × 26
     id firstname surname    year category  affiliation     city 
  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;           &lt;chr&gt;
1     4 Henri     Becquerel  1903 Physics   École Polytech… Paris
2     5 Pierre    Curie      1903 Physics   École municipa… Paris
3     6 Marie     Curie      1911 Chemistry Sorbonne Unive… Paris
4    11 Albert A. Michelson  1907 Physics   University of … Chic…
5    12 Gabriel   Lippmann   1908 Physics   Sorbonne Unive… Paris
6    14 Ferdinand Braun      1909 Physics   Strasbourg Uni… Stra…
# … with 382 more rows, and 19 more variables: country &lt;chr&gt;,
#   born_date &lt;date&gt;, died_date &lt;date&gt;, gender &lt;chr&gt;,
#   born_city &lt;chr&gt;, born_country &lt;chr&gt;,
#   born_country_code &lt;chr&gt;, died_city &lt;chr&gt;,
#   died_country &lt;chr&gt;, died_country_code &lt;chr&gt;,
#   overall_motivation &lt;chr&gt;, share &lt;dbl&gt;, motivation &lt;chr&gt;,
#   born_country_original &lt;chr&gt;, born_city_original &lt;chr&gt;, …
```

---

## Q&amp;A

&gt; How do I remember all this syntax and keep everything straight?

It takes work. But you can do it. Tips:

- Don't "just make it work".
- Understand *why* something works (explain it!)
- Try out variations!

---

## Data: Women in science 

Information on 10 women in science who changed the world

.small[

|name               |
|:------------------|
|Ada Lovelace       |
|Marie Curie        |
|Janaki Ammal       |
|Chien-Shiung Wu    |
|Katherine Johnson  |
|Rosalind Franklin  |
|Vera Rubin         |
|Gladys West        |
|Flossie Wong-Staal |
|Jennifer Doudna    |
]

.floating-source[
Source: [Discover Magazine](https://www.discovermagazine.com/the-sciences/meet-10-women-in-science-who-changed-the-world)
]

---


## Inputs

.panelset[

.panel[.panel-name[professions]

```r
professions
```

```
# A tibble: 10 × 2
   name               profession                        
   &lt;chr&gt;              &lt;chr&gt;                             
 1 Ada Lovelace       Mathematician                     
 2 Marie Curie        Physicist and Chemist             
 3 Janaki Ammal       Botanist                          
 4 Chien-Shiung Wu    Physicist                         
 5 Katherine Johnson  Mathematician                     
 6 Rosalind Franklin  Chemist                           
 7 Vera Rubin         Astronomer                        
 8 Gladys West        Mathematician                     
 9 Flossie Wong-Staal Virologist and Molecular Biologist
10 Jennifer Doudna    Biochemist                        
```
]

.panel[.panel-name[dates]

```r
dates
```

```
# A tibble: 8 × 3
  name               birth_year death_year
  &lt;chr&gt;                   &lt;int&gt;      &lt;int&gt;
1 Janaki Ammal             1897       1984
2 Chien-Shiung Wu          1912       1997
3 Katherine Johnson        1918       2020
4 Rosalind Franklin        1920       1958
5 Vera Rubin               1928       2016
6 Gladys West              1930         NA
7 Flossie Wong-Staal       1947         NA
8 Jennifer Doudna          1964         NA
```
]

.panel[.panel-name[notability]

```r
notability
```

```
# A tibble: 9 × 2
  name               known_for                                   
  &lt;chr&gt;              &lt;chr&gt;                                       
1 Ada Lovelace       first computer algorithm                    
2 Chien-Shiung Wu    confim and refine theory of radioactive bet…
3 Flossie Wong-Staal first scientist to clone HIV and create a m…
4 Gladys West        mathematical modeling of the shape of the E…
5 Janaki Ammal       hybrid species, biodiversity protection     
6 Jennifer Doudna    one of the primary developers of CRISPR, a …
7 Katherine Johnson  calculations of orbital mechanics critical …
8 Marie Curie        theory of radioactivity,  discovery of elem…
9 Vera Rubin         existence of dark matter                    
```
]

]

---

## Desired output


```
# A tibble: 10 × 5
   name               profession  birth_year death_year known_for
   &lt;chr&gt;              &lt;chr&gt;            &lt;int&gt;      &lt;int&gt; &lt;chr&gt;    
 1 Ada Lovelace       Mathematic…         NA         NA first co…
 2 Marie Curie        Physicist …         NA         NA theory o…
 3 Janaki Ammal       Botanist          1897       1984 hybrid s…
 4 Chien-Shiung Wu    Physicist         1912       1997 confim a…
 5 Katherine Johnson  Mathematic…       1918       2020 calculat…
 6 Rosalind Franklin  Chemist           1920       1958 &lt;NA&gt;     
 7 Vera Rubin         Astronomer        1928       2016 existenc…
 8 Gladys West        Mathematic…       1930         NA mathemat…
 9 Flossie Wong-Staal Virologist…       1947         NA first sc…
10 Jennifer Doudna    Biochemist        1964         NA one of t…
```

---

## First try: paste them together


|name               |profession                         |known_for                                                                                             |
|:------------------|:----------------------------------|:-----------------------------------------------------------------------------------------------------|
|Ada Lovelace       |Mathematician                      |first computer algorithm                                                                              |
|Marie Curie        |Physicist and Chemist              |confim and refine theory of radioactive beta decy, Wu experiment overturning theory of parity         |
|Janaki Ammal       |Botanist                           |first scientist to clone HIV and create a map of its genes which led to a test for the virus          |
|Chien-Shiung Wu    |Physicist                          |mathematical modeling of the shape of the Earth which served as the foundation of GPS technology      |
|Katherine Johnson  |Mathematician                      |hybrid species, biodiversity protection                                                               |
|Rosalind Franklin  |Chemist                            |one of the primary developers of CRISPR, a ground-breaking technology for editing genomes             |
|Vera Rubin         |Astronomer                         |calculations of orbital mechanics critical to sending the first Americans into space                  |
|Gladys West        |Mathematician                      |theory of radioactivity,  discovery of elements polonium and radium, first woman to win a Nobel Prize |
|Flossie Wong-Staal |Virologist and Molecular Biologist |existence of dark matter                                                                              |

---

## What was wrong?

--

How do we know which rows match up?

--

Need a **key**.

.question[What can serve as a **key** for this data?]

---

## **Mutating** joins

* I have a data frame `x`
* I want extra information about things in `x`
* Some other table, `y`, has that information.
* A "join" lets me look it up.
&lt;!-- * Needs a &lt;span style="background: blue; color: white; padding: 5px;"&gt;key&lt;/span&gt; : what has to match. Must match *exactly*. --&gt;

&lt;img src="img/original-dfs.png" width="30%" style="display: block; margin: auto;" /&gt;

.small[Graphics thanks to [tidyexplain](https://github.com/gadenbuie/tidyexplain)]


---

## Types of joins

If `x` and `y` match up one-to-one, no difference.

What to do when things don't exactly line up?

* **full** or **outer** join: Leave blanks (`NA`) for mismatches
* **inner** join: Drop rows with any mismatches
* **left** / **right** join: Drop rows where one of the sides has a mismatch

---

## Setup

.pull-left[



```r
x
```

```
# A tibble: 3 × 2
    key xdata
  &lt;dbl&gt; &lt;chr&gt;
1     1 x1   
2     2 x2   
3     3 x3   
```

```r
y
```

```
# A tibble: 3 × 2
    key ydata
  &lt;dbl&gt; &lt;chr&gt;
1     1 y1   
2     2 y2   
3     4 y4   
```
]
.pull-right[
&lt;img src="https://raw.githubusercontent.com/gadenbuie/tidyexplain/master/images/static/png/original-dfs.png" width="60%" style="display: block; margin: auto;" /&gt;
]

---

## `left_join()`

All rows from `x`.

.pull-left[

```r
left_join(x, y, by = "key")
```

```
# A tibble: 3 × 3
    key xdata ydata
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; 
```
]
.pull-right[
&lt;img src="img/left-join.gif" width="60%" style="display: block; margin: auto;" /&gt;
]


---

## `left_join()`


```r
professions %&gt;%
* left_join(dates)
```

```
# A tibble: 10 × 4
   name               profession            birth_year death_year
   &lt;chr&gt;              &lt;chr&gt;                      &lt;int&gt;      &lt;int&gt;
 1 Ada Lovelace       Mathematician                 NA         NA
 2 Marie Curie        Physicist and Chemist         NA         NA
 3 Janaki Ammal       Botanist                    1897       1984
 4 Chien-Shiung Wu    Physicist                   1912       1997
 5 Katherine Johnson  Mathematician               1918       2020
 6 Rosalind Franklin  Chemist                     1920       1958
 7 Vera Rubin         Astronomer                  1928       2016
 8 Gladys West        Mathematician               1930         NA
 9 Flossie Wong-Staal Virologist and Molec…       1947         NA
10 Jennifer Doudna    Biochemist                  1964         NA
```

---

## `right_join()`

All rows from `y`.

.pull-left[

```r
right_join(x, y)
```

```
# A tibble: 3 × 3
    key xdata ydata
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y4   
```
]
.pull-right[
&lt;img src="img/right-join.gif" width="60%" style="display: block; margin: auto;" /&gt;
]


---

## `right_join()`



```r
professions %&gt;%
* right_join(dates)
```

```
# A tibble: 8 × 4
  name               profession             birth_year death_year
  &lt;chr&gt;              &lt;chr&gt;                       &lt;int&gt;      &lt;int&gt;
1 Janaki Ammal       Botanist                     1897       1984
2 Chien-Shiung Wu    Physicist                    1912       1997
3 Katherine Johnson  Mathematician                1918       2020
4 Rosalind Franklin  Chemist                      1920       1958
5 Vera Rubin         Astronomer                   1928       2016
6 Gladys West        Mathematician                1930         NA
7 Flossie Wong-Staal Virologist and Molecu…       1947         NA
8 Jennifer Doudna    Biochemist                   1964         NA
```


---

## `full_join()`

All rows from both `x` and `y`. Leave `NA` for mismatches.

.pull-left[

```r
full_join(x, y, by = "key")
```

```
# A tibble: 4 × 3
    key xdata ydata
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; 
4     4 &lt;NA&gt;  y4   
```
]
.pull-right[
&lt;img src="img/full-join.gif" width="60%" style="display: block; margin: auto;" /&gt;
]

---

## `full_join()`


```r
dates %&gt;%
* full_join(notability)
```

```
# A tibble: 10 × 4
   name               birth_year death_year known_for            
   &lt;chr&gt;                   &lt;int&gt;      &lt;int&gt; &lt;chr&gt;                
 1 Janaki Ammal             1897       1984 hybrid species, biod…
 2 Chien-Shiung Wu          1912       1997 confim and refine th…
 3 Katherine Johnson        1918       2020 calculations of orbi…
 4 Rosalind Franklin        1920       1958 &lt;NA&gt;                 
 5 Vera Rubin               1928       2016 existence of dark ma…
 6 Gladys West              1930         NA mathematical modelin…
 7 Flossie Wong-Staal       1947         NA first scientist to c…
 8 Jennifer Doudna          1964         NA one of the primary d…
 9 Ada Lovelace               NA         NA first computer algor…
10 Marie Curie                NA         NA theory of radioactiv…
```


---

## `inner_join()`

All matching rows. Drops mismatches.

.pull-left[

```r
inner_join(x, y, by = "key")
```

```
# A tibble: 2 × 3
    key xdata ydata
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
```
]
.pull-right[
&lt;img src="img/inner-join.gif" width="60%" style="display: block; margin: auto;" /&gt;
]

---

## `inner_join()`


```r
dates %&gt;%
* inner_join(notability)
```

```
# A tibble: 7 × 4
  name               birth_year death_year known_for             
  &lt;chr&gt;                   &lt;int&gt;      &lt;int&gt; &lt;chr&gt;                 
1 Janaki Ammal             1897       1984 hybrid species, biodi…
2 Chien-Shiung Wu          1912       1997 confim and refine the…
3 Katherine Johnson        1918       2020 calculations of orbit…
4 Vera Rubin               1928       2016 existence of dark mat…
5 Gladys West              1930         NA mathematical modeling…
6 Flossie Wong-Staal       1947         NA first scientist to cl…
7 Jennifer Doudna          1964         NA one of the primary de…
```


---

## Summary of Mutating Joins

- `full_join()`: all rows from both `x` and `y`
- `inner_join()`: all *matching* rows from `x` where there are matching values in y.
- `left_join()`: all rows from `x`
- `right_join()`: all rows from `y`

Multiple matches? Return all combinations.

---


.question[
We want to get the dates and works of all the scientists. Which join function should we use?
]


```
# A tibble: 10 × 5
   name               profession  birth_year death_year known_for
   &lt;chr&gt;              &lt;chr&gt;            &lt;int&gt;      &lt;int&gt; &lt;chr&gt;    
 1 Ada Lovelace       Mathematic…         NA         NA first co…
 2 Marie Curie        Physicist …         NA         NA theory o…
 3 Janaki Ammal       Botanist          1897       1984 hybrid s…
 4 Chien-Shiung Wu    Physicist         1912       1997 confim a…
 5 Katherine Johnson  Mathematic…       1918       2020 calculat…
 6 Rosalind Franklin  Chemist           1920       1958 &lt;NA&gt;     
 7 Vera Rubin         Astronomer        1928       2016 existenc…
 8 Gladys West        Mathematic…       1930         NA mathemat…
 9 Flossie Wong-Staal Virologist…       1947         NA first sc…
10 Jennifer Doudna    Biochemist        1964         NA one of t…
```


---

.pull-left[

```r
names(professions)
```

```
[1] "name"       "profession"
```

```r
names(dates)
```

```
[1] "name"       "birth_year" "death_year"
```

```r
names(notability)
```

```
[1] "name"      "known_for"
```
]
.pull-right[

```r
nrow(professions)
```

```
[1] 10
```

```r
nrow(dates)
```

```
[1] 8
```

```r
nrow(notability)
```

```
[1] 9
```
]

---


```r
professions %&gt;%
  left_join(dates) %&gt;%
  left_join(notability)
```

```
# A tibble: 10 × 5
   name               profession  birth_year death_year known_for
   &lt;chr&gt;              &lt;chr&gt;            &lt;int&gt;      &lt;int&gt; &lt;chr&gt;    
 1 Ada Lovelace       Mathematic…         NA         NA first co…
 2 Marie Curie        Physicist …         NA         NA theory o…
 3 Janaki Ammal       Botanist          1897       1984 hybrid s…
 4 Chien-Shiung Wu    Physicist         1912       1997 confim a…
 5 Katherine Johnson  Mathematic…       1918       2020 calculat…
 6 Rosalind Franklin  Chemist           1920       1958 &lt;NA&gt;     
 7 Vera Rubin         Astronomer        1928       2016 existenc…
 8 Gladys West        Mathematic…       1930         NA mathemat…
 9 Flossie Wong-Staal Virologist…       1947         NA first sc…
10 Jennifer Doudna    Biochemist        1964         NA one of t…
```


---

class: middle

# Case study: Grocery sales

---

## Grocery sales

- Have:
  - *Purchases*: One row per customer per item, listing purchases they made
  - *Prices*: One row per item in the store, listing their prices
- **Want**: Total revenue



.pull-left[

```r
purchases
```


|customer_id |item         |
|:-----------|:------------|
|c1          |bread        |
|c1          |milk         |
|c1          |banana       |
|c2          |milk         |
|c2          |toilet paper |
]
.pull-right[

```r
prices
```


|item         | price|
|:------------|-----:|
|avocado      |  0.50|
|banana       |  0.15|
|bread        |  1.00|
|milk         |  0.80|
|toilet paper |  3.00|

]

---

## Grocery sales


```r
purchases %&gt;% 
* left_join(prices)
```

```
# A tibble: 5 × 3
  customer_id item         price
  &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt;
1 c1          bread         1   
2 c1          milk          0.8 
3 c1          banana        0.15
4 c2          milk          0.8 
5 c2          toilet paper  3   
```


---

## Grocery sales

.panelset[

.panel[.panel-name[Total revenue]
.pull-left[

```r
purchases %&gt;% 
* left_join(prices)
```

```
# A tibble: 5 × 3
  customer_id item         price
  &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt;
1 c1          bread         1   
2 c1          milk          0.8 
3 c1          banana        0.15
4 c2          milk          0.8 
5 c2          toilet paper  3   
```
]
.pull-right[

```r
purchases %&gt;% 
  left_join(prices) %&gt;%
* summarize(total_revenue = sum(price))
```

```
# A tibble: 1 × 1
  total_revenue
          &lt;dbl&gt;
1          5.75
```
]
]

.panel[.panel-name[Revenue per customer]

.pull-left[

```r
purchases %&gt;% 
  left_join(prices)
```

```
# A tibble: 5 × 3
  customer_id item         price
  &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt;
1 c1          bread         1   
2 c1          milk          0.8 
3 c1          banana        0.15
4 c2          milk          0.8 
5 c2          toilet paper  3   
```
]
.pull-right[

```r
purchases %&gt;% 
  left_join(prices) %&gt;%
* group_by(customer_id) %&gt;%
  summarize(total_revenue = sum(price))
```

```
# A tibble: 2 × 2
  customer_id total_revenue
  &lt;chr&gt;               &lt;dbl&gt;
1 c1                   1.95
2 c2                   3.8 
```
]

]

]

---

## Extension: Multiple matching rows

.panelset[

.panel[.panel-name[professions_multi]

```r
professions_multi
```

```
# A tibble: 12 × 2
  name              profession   
  &lt;chr&gt;             &lt;chr&gt;        
1 Ada Lovelace      Mathematician
2 Marie Curie       Physicist    
3 Marie Curie       Chemist      
4 Janaki Ammal      Botanist     
5 Chien-Shiung Wu   Physicist    
6 Katherine Johnson Mathematician
# … with 6 more rows
```
]

.panel[.panel-name[dates]

```r
dates
```

```
# A tibble: 8 × 3
  name               birth_year death_year
  &lt;chr&gt;                   &lt;int&gt;      &lt;int&gt;
1 Janaki Ammal             1897       1984
2 Chien-Shiung Wu          1912       1997
3 Katherine Johnson        1918       2020
4 Rosalind Franklin        1920       1958
5 Vera Rubin               1928       2016
6 Gladys West              1930         NA
7 Flossie Wong-Staal       1947         NA
8 Jennifer Doudna          1964         NA
```
]

.panel[.panel-name[notability_multi]

```r
notability_multi
```

```
# A tibble: 13 × 2
  name         known_for                                
  &lt;chr&gt;        &lt;chr&gt;                                    
1 Ada Lovelace first computer algorithm                 
2 Marie Curie  theory of radioactivity                  
3 Marie Curie  discovery of elements polonium and radium
4 Marie Curie  first woman to win a Nobel Prize         
5 Janaki Ammal hybrid species                           
6 Janaki Ammal biodiversity protection                  
# … with 7 more rows
```
]

]


---

## Other types of joins

These are less common:

*filtering* joins

- `semi_join()`: include a row from `x` only if there's some match in `y`
- `anti_join()`: include a row from `x` only if there's *no* match in `y`

*nest* join

- `nest_join()`: get bundles of all matching rows from `y` (most flexible)

---

## Specifying keys

- Keys must match *exactly*
- Can join on multiple columns (first name **and** last name)
- Default join: columns with same names
- Specify what columns to use: `left_join(x, y, by = c("first_name", "last_name"))`

---

class: center, middle

## General notes


---

## A note on `mutate`

* Badly named. Think "add_computed_column".
* **DON'T** think of it operating on a variable ("mutate the ride's start time").
* **DO** think of it operating on a data frame ("add a column computed by
flooring the start time)

---

## Speaking of better names

&gt; `select` vs `filter`?

Maybe should have been named `select_columns` and `select_rows`.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "4:3",
"highlightLines": true,
"highlightStyle": "solarized-light",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
