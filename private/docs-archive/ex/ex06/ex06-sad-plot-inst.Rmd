---
title: "Guided Exercise 06 - Sad Plots"
output: 
  tufte::tufte_html:
    css: ../ex.css
    tufte_variant: "envisioned"
    highlight: pygments
link-citations: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

The data visualization that's easiest to make with software is rarely the best design
for human perception and cognition. In this lab, we'll build on what we studied
about visualization design and combine it with our new data wrangling skills to be able to critique and improve plots.

The learning goals for this lab are:

* Telling a story with data
* Some commonly helpful practices in data visualization
* Apply and extend your data wrangling skills.

Relevant readings include:

* [Look at Data](https://socviz.co/lookatdata.html#visual-tasks-and-decoding-graphs)

## Getting started

Pull your portfolio repo as usual.

## Take a sad plot and make it better

### Instructional staff employment trends

The American Association of 
University Professors (AAUP) is a nonprofit membership association of faculty 
and other academic professionals. 
[This report](https://www.aaup.org/sites/default/files/files/AAUP_Report_InstrStaff-75-11_apr2013.pdf) 
compiled by the AAUP shows trends in instructional staff employees between 1975 
and 2011, and contains an image very similar to the one given below.

Suppose you want to use this data in an article about part-time faculty, making the claim that part-time faculty are on the rise.

```{r echo=FALSE, fig.fullwidth=TRUE}
knitr::include_graphics("img/staff-employment.png")
```

::: {.exercises}

1. Analyze this plot: what type of plot is it? What variables are mapped to what aesthetics? What is easy to see, what is hard to see?

2. Sketch on paper two alternative designs for this plot. Consider the goal: supporting the claim that part-time faculty are on the rise.

3. Remake the original plot.

Let's start by loading the data used to create this plot.

```{r load-data-staff, message=FALSE, eval=TRUE}
staff <- read_csv("data/instructional-staff.csv")
```

Now, see if you can make a plot that looks like this:

```{r echo=FALSE}
staff_long <- staff %>%
  pivot_longer(cols = !faculty_type, names_to = "year", values_to = "percentage") %>%
  mutate(year = as.numeric(year))
```


```{r staff-barplot, echo=FALSE}
staff_long %>%
  ggplot(aes(y = faculty_type, x = percentage, fill = factor(year))) +
  geom_col(position = "dodge") +
  scale_fill_viridis_d() +
  labs(x = "% of faculty", y = "", fill = "",
       title = "Instructional staff employment trends, 1975-2011",
       caption = "Source: AAUP")
```

You'll need the following:

- `pivot_longer`
- `geom_col(position = "dodge")`
- `scale_fill_viridis_d`
- `labs()` parameters: `x`, `y`, `fill`, `title`, `caption`

4. Make a stacked bar plot instead.

```{r echo=FALSE}
staff_long %>%
  group_by(year) %>% 
  mutate(percentage = percentage / sum(percentage) * 100) %>% 
  ggplot(aes(x = percentage, y = factor(year), fill = faculty_type)) +
  geom_col() +
  scale_fill_viridis_d() +
  labs(x = "% of faculty", y = "Year", fill = "",
       title = "Instructional staff employment trends, 1975-2011",
       caption = "Source: AAUP") +
  theme_minimal()
```


Notes:

- See if you can do this without repeating the `pivot_longer`.
- I used `theme_minimal()`.

5. Make a line plot instead:

```{r staff-lineplot, echo=FALSE}
staff_long %>%
  ggplot(aes(x = year, y = percentage, group = faculty_type, color = faculty_type, shape = faculty_type)) +
  geom_line() +
  geom_point() +
  labs(y = "% of faculty", x = "year", color = "", shape = "",
     title = "Instructional staff employment trends, 1975-2011",
     caption = "Source: AAUP")
```

Notes:

- Note the use of a redundant encoding (`shape`). I had to add a `geom_point` layer to draw those.
- Make sure that the year is treated `as.numeric`.
- If you made changes to earlier code, make sure your earlier plots still work. (You may need to replace `year` with `factor(year)` in those plots, depending on how you did it.)

6. *optional*: Make this data frame. Can you do it starting with your *long*-format data? Can you do it without using `select()`? Tip: `2011` isn't normally a valid variable name, but you can use backticks (next to the 1 key): `` `2011` ``.

```{r echo=FALSE}
staff_long %>%
  filter(year == 1975 | year == 2011) %>% 
  pivot_wider(names_from = "year", values_from = "percentage") %>% 
  mutate(change = `2011` - `1975`) %>% knitr::kable()
```



`r emo::ji("white_check_mark")` `r emo::ji("arrow_up")` *Commit and push your changes to GitHub with an appropriate commit message again. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.*

### Fisheries

Fisheries and Aquaculture Department of the Food and 
Agriculture Organization of the United Nations collects data on fisheries 
production of countries. [This Wikipedia page](https://en.wikipedia.org/wiki/Fishing_industry_by_country) 
lists fishery production of countries for 2016. For each country tonnage from 
capture and aquaculture are listed. Note that countries whose total harvest was 
less than 100,000 tons are not included in the visualization.

A researcher shared with you the following visualization they created based on 
these data `r emo::ji("flushed")`.

```{r echo=FALSE, fig.fullwidth=TRUE}
knitr::include_graphics("img/fisheries.png")
```

7. Can you help them make improve it? First, brainstorm how you would improve it. Then create the improved visualization and write up the changes/decisions you made as bullet points. It’s ok if some of your improvements are aspirational, i.e. you don’t know how to implement it, but you think it’s a good idea.

8. Create a new data visualisation for these data that implements the improvements you proposed in the previous exercise (or many of them as you can).


```{r load-data-fisheries, message=FALSE}
fisheries <- read_csv("data/fisheries.csv")
```

```{r include=FALSE}
fisheries %>% 
  select(!total) %>% 
  pivot_longer(!country) %>% 
  mutate(country = fct_other(country, keep = c("China", "Indonesia", "India", "Peru"))) %>% 
  ggplot(aes(x = name, y = value, fill = country)) +
    geom_col(position = "fill")
```


```{r include=FALSE}
fisheries %>% 
  pivot_longer(!c(country, total)) %>% 
  ggplot(aes(y = #fct_rev(country),
             fct_lump_n(country, n = 20, w = total),
             x = value, fill = name)) +
    geom_col()
```


`r emo::ji("white_check_mark")` `r emo::ji("arrow_up")` *Commit and push your changes to GitHub with an appropriate commit message again. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.*

:::

## Wrapping up

Go back through your write up to make sure you're following coding style 
guidelines we discussed in class. Make any edits as needed.

Also, make sure all of your R chunks are properly labeled, and your figures 
are reasonably sized.

## More ugly charts

Want to see more ugly charts?

- [Flowing Data - Ugly Charts](https://flowingdata.com/category/visualization/ugly-visualization/)
- [Reddit - Data is ugly](https://www.reddit.com/r/dataisugly/)
- [Missed Opportunities and Graphical Failures](http://www.datavis.ca/gallery/missed.php)
- [(Mostly Bad) Graphics and Tables](http://users.stat.umn.edu/~rend0020/Teaching/STAT8801-resources/graphics/index.html)



## Acknowledgments

This lab was based on [DSBox Lab 6](https://rstudio-education.github.io/datascience-box/course-materials/lab-instructions/lab-06/lab-06-sad-plots.html)
